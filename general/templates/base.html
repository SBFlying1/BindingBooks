<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>
          {% block title %}
            BindingBooks
          {% endblock %}
        </title>
        <link rel="icon" type="image/x-icon" href="../../static/general/assets/favicon.ico" />
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        {% load static %}
        <link rel="stylesheet" href="{% static 'dark-mode.css' %}" />
        <link rel="stylesheet" href="{% static 'forums/forums.css' %}" />
        <link rel="stylesheet" href="{% static 'general/styles.css' %}" />
    </head>
    <body>
        <header>
            <h1 class="site-heading text-center text-faded d-none d-lg-block">
                <span class="site-heading-lower" href="{% url 'home' %}">Binding Books</span>
                <span class="site-heading-upper text-primary mb-3">The Best Place For All Your Book-Based Needs</span>
            </h1>
        </header>

        <!-- Mobile Toggle -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark py-lg-4" id="mainNav">
            <div class="container">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item px-lg-4"><a class="nav-link text-uppercase" href="{% url 'home' %}">Home</a></li>
                        {% if user.is_authenticated %}
                        <li class="nav-item px-lg-4"><a class="nav-link text-uppercase" href="{% url 'forum_list' %}">Forums</a></li>
                        {% endif %}
                        <li class="nav-item px-lg-4"><a class="nav-link text-uppercase" href="{% url 'products:product_list' %}">Products</a></li>
                        {% if request.user.is_superuser %}
                          <a href="{% url 'moderation_queue' %}" class='nav-link px-2'>Moderation Queue</a>
                        {% endif %}
                        {% block extra_nav %}

                        {% endblock %}
                    </ul>
                </div>
            </div>

            {% if user.is_authenticated %}
            <!-- Profile Dropdown -->
            <ul class="navbar-nav">
              <li class="nav-item dropdown">

                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" 
                  role="button" data-bs-toggle="dropdown" aria-expanded="false">

                  <!-- Profile Image -->
                  {% if user.profile_image %}
                  <img src="{{ user.profile_image.url }}" 
                      alt="profile"
                      class="rounded-circle"
                      style="width:32px; height:32px; object-fit:cover; margin-right:8px;">
                  {% else %}
                  <img src="/static/default_profile.png"
                      class="rounded-circle"
                      style="width:32px; height:32px; object-fit:cover; margin-right:8px;">
                  {% endif %}

                  {{ user.username }}
                </a>

                <ul class="dropdown-menu dropdown-menu-end">
                  <li><a class="dropdown-item" href="{% url 'accounts:profile' %}">Profile</a></li>
                  <li><a class="dropdown-item" href="{% url 'accounts:password_change' %}">Change password</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <form method="post" action="{% url 'accounts:logout' %}" style="display:inline;">
                      {% csrf_token %}
                      <button type="submit" class="dropdown-item">Logout</button>
                    </form>
                  </li>
                </ul>
              </li>
              <button class="btn btn-link nav-link ms-3" id="theme-toggle" aria-label="Toggle dark mode">
                <i id="theme-icon" class="bi bi-moon-stars-fill"></i>
              </button>
            </ul>
            {% else %}
            <a href="{% url 'accounts:login' %}" class="btn btn-outline-secondary">Log in</a>
            <a href="{% url 'accounts:signup' %}" class="btn btn-primary">Sign up</a>
            {% endif %}
        </nav>

        <main>
          <div class="container py-4">
            {% block content %}

            {% endblock %}
          </div>
        </main>

        <footer class="footer text-faded text-center py-5">
            <div class="container"><p class="m-0 small">Copyright &copy; Binding Books Development Team, 2025</p></div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <script src="{% static 'dark-mode.js' %}"></script>
    </body>
</html>
