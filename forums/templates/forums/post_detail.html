{% extends 'base.html' %}
{% load static %}

{% block title %}
  {{ post.forum.forum_name }} | BindingBooks
{% endblock %}
{% block extra_nav %}
  <ul class="navbar-nav">
    <li class="nav-item px-lg-4">
      <a class="nav-link text-uppercase" href="{% url 'forum_detail' post.forum.forum_id %}">‚Üê Back to {{ post.forum.forum_name }}</a>
    </li>
  </ul>
{% endblock %}
{% block content %}
  <div class="container mt-4">
    <div class="row">
      <div class="col-12">
        <h1 class="text-center mb-4">Post by {{ post.author.username|default:'Unknown author' }}</h1>

        <div style="background: rgba(255, 255, 255, 0.8); border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
          <h5 class="mb-3">{{ post.author.username|default:'Unknown author' }}</h5>
          <p>{{ post.post_text }}</p>
        </div>

        <h3 class="mb-4">Comments</h3>
        {% for c in comments %}
          {% if c.approved == True %}
            <div style="background: rgba(255, 255, 255, 0.75); border: 1px solid rgba(0,0,0,0.1); border-radius: 6px; padding: 1.25rem; margin-bottom: 1rem;">
              <h6 class="fw-bold mb-2">{{ c.author.username|default:'Unknown author' }}</h6>
              <p class="mb-0">{{ c.comment_text }}</p>
            </div>
          {% endif %}
        {% empty %}
          <p>No comments yet. Be the first to comment!</p>
        {% endfor %}

        <div style="background: rgba(255, 255, 255, 0.85); border: 1px solid rgba(0,0,0,0.15); border-radius: 8px; padding: 2rem; margin-top: 2rem;">
          <h4 class="mb-3">Add a Comment</h4>
          {% if user.is_authenticated %}
            <form action="{% url 'create_comment' post.post_id %}" method="POST">
              {% csrf_token %}
              <div class="mb-3">
                <textarea 
                  name="text" 
                  class="form-control" 
                  rows="4" 
                  placeholder="Write your comment..."
                  required
                ></textarea>
              </div>
              <button type="submit" class="btn btn-primary">Submit Comment</button>
            </form>
          {% else %}
            <p>You must <a href="{% url 'accounts:login' %}">log in</a> to comment.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}
